{% assign repo_url = include.repository | split: '/' %}
{% if site.data.repositories.github_users contains repo_url.first %}
  {% assign show_owner = false %}
{% else %}
  {% assign show_owner = true %}
{% endif %}

{% if site.data.repositories.use_github_api %}
  {% comment %} Use GitHub API rendering {% endcomment %}
  {% include repository/repo_api.liquid repository=include.repository %}
{% else %}
  {% comment %} Use github-readme-stats rendering (default) {% endcomment %}
  {% assign lang = site.lang | split: '-' | first %}

  {% case lang %}
    {% when 'pt' %}
      {% assign lang = site.lang %}

    {% when 'zh' %}
      {% assign lang_last = site.lang | split: '-' | last %}
      {% case lang_last %}
        {% when 'cn', 'sg', 'my', 'hans' %}
          {% assign lang = 'cn' %}
        {% when 'tw', 'hk', 'mo', 'hant' %}
          {% assign lang = 'zh-tw' %}
      {% endcase %}
  {% endcase %}

  {% if site.data.repositories.repo_description_lines_max %}
    {% assign max_lines = site.data.repositories.repo_description_lines_max %}
  {% else %}
    {% assign max_lines = 2 %}
  {% endif %}

  {% assign github_token = '' %}
  {% if site.data.repositories.github_token %}
    {% assign github_token = '&token=' | append: site.data.repositories.github_token %}
  {% endif %}

  <div class="repo p-2 text-center">
    <a href="https://github.com/{{ include.repository }}">
      <img
        class="only-light w-100"
        alt="{{ include.repository }}"
        src="https://github-readme-stats.vercel.app/api/pin/?username={{ repo_url[0] }}&repo={{ repo_url[1] }}&theme={{ site.repo_theme_light }}&locale={{ lang }}&show_owner={{ show_owner }}&description_lines={{ max_lines }}{{ github_token }}"
      >
      <img
        class="only-dark w-100"
        alt="{{ include.repository }}"
        src="https://github-readme-stats.vercel.app/api/pin/?username={{ repo_url[0] }}&repo={{ repo_url[1] }}&theme={{ site.repo_theme_dark }}&locale={{ lang }}&show_owner={{ show_owner }}&description_lines={{ max_lines }}{{ github_token }}"
      >
    </a>
  </div>
{% endif %}
